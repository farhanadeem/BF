<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <title>Memory Allocation and Deallocation Bugs (MAL) Examples</title>
  <!-- Bootstrap core CSS-->
  <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <!-- Custom fonts for this template-->
  <link href="https://fonts.googleapis.com/css?family=Cinzel" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto|Source%20Code%20Pro" rel="stylesheet" type="text/css">
  <link href="../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <!-- Custom styles for this template-->
  <link href="../css/styles.css" rel="stylesheet">
</head>

<body class="fixed-nav sticky-footer bg-light" id="page-top">
  <!-- Navigation-->
  <nav class="navbar navbar-expand-lg navbar-light bg-lightt fixed-top" id="mainNav">

    <div class="collapse navbar-collapse" id="navbarsExampleContainer">
      <div class="mr-auto">
        <img class="" src="../images/nist.png"></img>
        <img class="" src="../images/samate.png"></img>

        <fontTT>The Bugs Framework (BF) <span class="remove">-</span> </fontTT>
        <fontSS> <span class="remove">
            <red>Software developers' and testers' "Best Friend"<red>
          </span>
          <fontSS>
      </div>
      <form class="form-inline my-2 my-md-0" action="../search.html">
        <input class="form-control mr-sm-2 tipue_search_input" type="text" placeholder="Search" name="q"
          id="tipue_search_input">
        <button class="btn btn-outline-success my-2 my-sm-0 enableOnInput" type="submit"
          disabled="disabled">Search</button>
      </form>
    </div>
  </nav>
  <!-- Navigation-->
  <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top" id="mainNav">
    <div class="mobile">
      <img class="img-fluid" src="../images/nist.png"></img>
      <img class="img-fluid" src="../images/samate.png"></img>


    </div><span class="ml-auto mobile">
      <fontTT>The Bugs Framework (BF)</fontTT>
    </span>
    <span class="mr-auto mobile2">
      <fontTT>The Bugs Framework</fontTT>
    </span>
    <button class="navbar-toggler navbar-toggler-right ml-auto" type="button" data-toggle="collapse"
      data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
      aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav navbar-sidenav" id="exampleAccordion">
        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Home">
          <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents2"
            data-parent="#exampleAccordion">
            <i class="fa fa-fw fa-home"></i>
            <span class="nav-link-text">BF Home</span>
          </a>
          <ul class="sidenav-second-level collapse" id="collapseComponents2">
            <li>
              <a href="../Home/Terminology.html">Terminology</a>
            </li>
            <li>
              <a href="../Home/Why.html">Why BF?</a>
            </li>
            <li>
              <a href="../index.html">Overview</a>
            </li>
            <li>
              <a href="../Home/Approach.html">Approach</a>
            </li>
            <li>
              <a href="../Home/Methodology.html">Methodology</a>
            </li>
            <li>
              <a href="../Home/Impacts.html">Potential Impacts</a>
            </li>
          </ul>
        </li>

        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Classes">
          <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents3"
            data-parent="#exampleAccordion">
            <i class="fa fa-fw fa-table"></i>
            <span class="nav-link-text">Classes</span>
          </a>
          <ul class="sidenav-second-level collapse" id="collapseComponents3">

            <li class="nav-item" data-toggle="tooltip" data-placement="right" title="">
              <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents11">

                <span class="nav-link-text">
                  <fontL>ATN, AUT</fontL>
                </span>
              </a>

              <ul class="sidenav-third-level collapse " id="collapseComponents11">

                <li>
                  <a href="../Classes/ATN.html">
                    <fontL>ATN</fontL>
                  </a>
                </li>

                <li>
                  <a href="../Classes/AUT.html">
                    <fontL>AUT</fontL>
                  </a>
                </li>
              </ul>
            </li>

            <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Data Check">
              <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents27">

                <span class="nav-link-text">DVL, DVR</span>
              </a>

              <ul class="sidenav-third-level collapse " id="collapseComponents27">

                <li>
                  <a href="../Classes/DVL.html">DVL</a>
                </li>

                <li>
                  <a href="../Classes/DVR.html">DVR</a>
                </li>
              </ul>
            </li>



            <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Cryptography">
              <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents6">

                <span class="nav-link-text">ENC, KMN, VRF</span>
              </a>

              <ul class="sidenav-third-level collapse " id="collapseComponents6">

                <li>
                  <a href="../Classes/CRY.html">Model</a>
                </li>

                <li>
                  <a href="../Classes/ENC.html">ENC</a>
                </li>


                <li>
                  <a href="../Classes/KMN.html">KMN</a>
                </li>



                <li>
                  <a href="../Classes/VRF.html">VRF</a>
                </li>
              </ul>
            </li>




            <li class="nav-item" data-toggle="tooltip" data-placement="right" title="IEX">
              <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents10">

                <span class="nav-link-text">IEX</span>
              </a>

              <ul class="sidenav-third-level collapse " id="collapseComponents10">

                <li>
                  <a href="../Classes/IEXModel.html">Model</a>
                </li>

                <li>
                  <a href="../Classes/IEX.html">IEX</a>
                </li>




              </ul>
            </li>







            <li class="nav-item" data-toggle="tooltip" data-placement="right" title="">
              <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents14">

                <span class="nav-link-text">MAD, MAL, MUS, MDL</span>
              </a>

              <ul class="sidenav-third-level collapse " id="collapseComponents14">
                <li>
                  <a href="../Classes/MEMModel.html">Model</a>
                </li>
                <li>
                  <a href="../Classes/MAD.html">MAD</a>
                </li>
                <li>
                  <a href="../Classes/MAL.html">MAL</a>
                </li>
                <li>
                  <a href="../Classes/MUS.html">MUS</a>
                </li>
                <li>
                  <a href="../Classes/MDL.html">MDL</a>
                </li>
                <li>
                  <a href="../Classes/relation.html">Relation to CWEs</a>
                </li>
              </ul>
            </li>




            <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Cryptography">
              <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents7">

                <span class="nav-link-text">PRN, TRN </span>
              </a>

              <ul class="sidenav-third-level collapse " id="collapseComponents7">

                <li>
                  <a href="../Classes/RNModel.html">Model</a>
                </li>

                <li>
                  <a href="../Classes/PRN.html">PRN</a>
                </li>

                <li>
                  <a href="../Classes/TRN.html">TRN</a>
                </li>



              </ul>
            </li>





          </ul>
        </li>
        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Examples">
          <a class="nav-link nav-link-collapse" data-toggle="collapse" href="#collapseComponents"
            data-parent="#exampleAccordion">
            <i class="fa fa-fw fa-star"></i>
            <span class="nav-link-text">Examples</span>
          </a>
          <ul class="sidenav-second-level collapse show" id="collapseComponents">

            <li class="nav-item" data-toggle="tooltip" data-placement="right" title="">
              <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents16">

                <span class="nav-link-text">
                  <fontL>ATN, AUT</fontL>
                </span>
              </a>

              <ul class="sidenav-third-level collapse " id="collapseComponents16">

                <li>
                  <a href="ATN.html">
                    <fontL>ATN</fontL>
                  </a>
                </li>

                <li>
                  <a href="AUT.html">
                    <fontL>AUT</fontL>
                  </a>
                </li>
              </ul>
            </li>

<li class="nav-item" data-toggle="tooltip" data-placement="right" title="Data Check">
              <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents28">

                <span class="nav-link-text">DVL, DVR</span>
              </a>

              <ul class="sidenav-third-level collapse " id="collapseComponents28"> 

                <li>
                  <a href="DVL.html">DVL</a>
                </li>


                <li>
                  <a href="DVR.html">DVR</a>
                </li>
              </ul>
            </li>



            <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Cryptography">
              <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents19">

                <span class="nav-link-text">ENC, KMN, VRF</span>
              </a>

              <ul class="sidenav-third-level collapse " id="collapseComponents19">


                <li>
                  <a href="ENC.html">ENC</a>
                </li>


                <li>
                  <a href="KMN.html">KMN</a>
                </li>



                <li>
                  <a href="VRF.html">VRF</a>
                </li>
              </ul>
            </li>






            <li>
              <a href="IEX.html">IEX</a>
            </li>








            <li class="nav-item" data-toggle="tooltip" data-placement="right" title="">
              <a class="nav-link nav-link-collapse" data-toggle="collapse" href="#collapseComponents17">

                <span class="nav-link-text">MAD, MAL, MUS, MDL</span>
              </a>

              <ul class="sidenav-third-level collapse show" id="collapseComponents17">

                <li>
                  <a href="MAD.html">MAD</a>
                </li>
                <li class="active">
                  <a href="MAL.html">MAL</a>
                </li>
                <li>
                  <a href="MUS.html">MUS</a>
                </li>
                <li>
                  <a href="MDL.html">MDL</a>
                </li>

              </ul>
            </li>


            <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Cryptography">
              <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents21">

                <span class="nav-link-text">PRN, TRN </span>
              </a>

              <ul class="sidenav-third-level collapse " id="collapseComponents21">

                <li>
                  <a href="PRN.html">PRN</a>
                </li>

                <li>
                  <a href="TRN.html">TRN</a>
                </li>



              </ul>
            </li>





          </ul>
        </li>

        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Old">
          <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents35"
            data-parent="#exampleAccordion">
            <i class="fa fa-fw fa-star"></i>
            <span class="nav-link-text">Deprecated</span>
          </a>

          <ul class="sidenav-second-level collapse " id="collapseComponents35">




            <li class="nav-item" data-toggle="tooltip" data-placement="right" title="">
              <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents36">

                <span class="nav-link-text">Classes</span>
              </a>

              <ul class="sidenav-third-level collapse " id="collapseComponents36">

                <li>
                  <a href="../Old/ARCClass.html">ARC</a>
                </li>
<li>
                  <a href="../Old/BOFClass.html">BOF</a>
                </li>
                <li>
                  <a href="../Old/CIFClass.html">CIF</a>
                </li>
                <li>
                  <a href="../Old/INJClass.html">INJ</a>
                </li>


              </ul>
            </li>
            <li class="nav-item" data-toggle="tooltip" data-placement="right" title="">
              <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents37">

                <span class="nav-link-text">Examples</span>
              </a>

              <ul class="sidenav-third-level collapse " id="collapseComponents37">

                <li>
                  <a href="../Old/BOFExample.html">BOF</a>
                </li>
                <li>
                  <a href="../Old/CIFExample.html">CIF</a>
                </li>
                <li>
                  <a href="../Old/INJExample.html">INJ</a>
                </li>


              </ul>
            </li>


          </ul>
        </li>
        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Enlightenment">
          <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents4"
            data-parent="#exampleAccordion">
            <i class="fa fa-fw fa-lightbulb-o"></i>
            <span class="nav-link-text">Enlightenment</span>
          </a>
          <ul class="sidenav-second-level collapse" id="collapseComponents4">
            <li>
              <a href="../Background/index.html">Background</a>
            </li>

            <li>
              <a href="../Enlightenment/otherclassifications.html">Other Classifications</a>
            </li>

          </ul>
        </li>
        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Publications">
          <a class="nav-link" href="../Publications/index.html">
            <i class="fa fa-fw fa-book"></i>
            <span class="nav-link-text">Publications</span>
          </a>
        </li>
        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Team">
          <a class="nav-link" href="../Team/index.html">
            <i class="fa fa-fw fa-users"></i>
            <span class="nav-link-text">Team</span>
          </a>
        </li>
        <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Contact">
          <a class="nav-link" href="../Home/Contact Info.html">
            <i class="fa fa-fw fa-user-plus"></i>
            <span class="nav-link-text">Contact Us</span>
          </a>
        </li>
      </ul>
      <ul class="navbar-nav sidenav-toggler">
        <li class="nav-item">
          <a class="nav-link text-center" id="sidenavToggler">
            <i class="fa fa-fw fa-angle-left"></i>
          </a>
        </li>
      </ul>
      <form class="form-inline my-2 my-md-0 mobile mobile2" action="../search.html">
        <input class="form-control mr-sm-2 tipue_search_input" type="text" placeholder="Search" name="q"
          id="tipue_search_input">
        <button class="btn btn-outline-success my-2 my-sm-0 enableOnInput" type="submit"
          disabled="disabled">Search</button>
      </form>
    </div>
  </nav>
  <div class="content-wrapper">
    <div class="container-fluid" align="center">

      <fontST>Memory Allocation and Deallocation Bugs (MAL) Examples</fontST>
    </div>
    <ul>To be added.</ul>
    <!--
<div class="container-fluid" align="left">
  <p class="text-info"><fontS>CVE-2016-1919</fontS></p>
  <p><fontSS>BF Taxonomy</fontSS></p>
  <ul><strong>Cause: </strong><sub-cause>Missing Verifcation Step</sub-cause> (challenge-response) in public key authentication</ul>
  <ul><strong>Attributes: </strong>
    <ul>Verified Data: Any <attribute>Secret</attribute>/<attribute>Public</attribute></ul>
    <ul>Data State: <attribute>Transferred </attribute>(over network)</ul>
    <ul>Algorithm: <attribute>Digital Signature </attribute>(not using such allows private key not to be verified by public key)</ul>
    <ul><u>Security Service</u>: <attribute>Identity Authentication</attribute></ul>
  </ul>

  <ul><strong>Consequence: </strong><consequence>IEX</consequence></ul>
  <ul>To be added.</ul>
  <p><fontSS>BF Description</fontSS></p>
  <ul><fontN>A</fontN> <u>KMN</u> <fontN>leads to an</fontN> <u>ENC</u>.</ul>
  <ul><u>KMN</u>: <fontN>Use of <sub-cause>weak algorithm</sub-cause> (eCryptFS-key from password and stored TIMA key) allows <attribute>generation</attribute> of <attribute>keying material</attribute> (secret key) that can be obtained through brute force, which may be exploited for <consequence>IEX of keying material</consequence> (secret key).</fontN></ul>
  <ul><u>ENC</u>: <cause>KMN fault</cause> leads to <cause>exposed secret key</cause> that allows decryption of <attribute>stored</attribute> (on disk) <attribute>sensitive data</attribute>, which is <attribute>confidentiality</attribute> failure and may be exploited for <consequence>IEX of sensitive data</consequence>. <a href="#ref">[1]</a></ul>
<p><fontSS>CVE Description</fontSS></p>
      <p><ul>"Samsung KNOX 1.0 uses a weak eCryptFS Key generation algorithm, which makes it easier for local users to obtain sensitive information by leveraging knowledge of the TIMA key and a brute-force attack." <a href="#ref">[2]</a></ul></p>
  <p><fontSS>Analysis</fontSS></p>
      <p><ul>The following analysis is based on information in <a href="#ref">[3]</a>: The TIMA key is a random stored byte string. The secret key used is obtained by XOR of the TIMA key and the password characters, where the minimum password length is 7. However, if the password length is no more than 8, a base 64 expansion results in a key that does not depend on the password. The TIMA key is stored, and for a known TIMA key, the key is known, or, if the password length slightly exceeds 8, there is a small set of possible keys. The TIMA key can be obtained using a preliminary step.</ul></p>
  <p>
      <fontSS>Source Code</fontSS>
  </p>
  <p>
      <ul>
          <table align="center">
              <tr>
                  <td align="center"> Code With Bug</td>
                  <td align="center"> Code With Fix</td>
              </tr>
              <tr>
                  <td>
                      <div class="sourceCodeTable">
                          <table>
                              <tr>
                                  <td><pre style="margin: 0; line-height: 125%">Source Code Not Available</pre>
                                  </td>
                              </tr>
                          </table>
                      </div>
                  </td>
                  <td>
                      <div class="sourceCodeTable">
                          <table>
                              <tr>
                                  <td><pre style="margin: 0; line-height: 125%">Source Code Not Available</pre>
                                  </td>
                              </tr>
                          </table>
                      </div>
                  </td>
              </tr>
          </table>
      </ul>
  </p>

  <p class="text-info"><fontS>CVE-2015-0204, 1637, 1067 (FREAK - Factoring attack on RSA-Export Keys)</fontS></p>
  <p><fontSS>BF Taxonomy</fontSS></p>
  <ul>An inner <u>KMN</u> leads to an inner <u>ENC</u>, which leads to an outer <u>ENC</u>.</ul>

  <ul><u>Inner KMN</u>:</ul>
  <ul><strong>Cause: </strong><cause>Improper Offer of Weak Protocol </cause>(Export RSA – offered from MITM-tricked server and accepted by client)</ul>
  <ul><strong>Attributes:</strong>
    <ul>Cryptographic Data: <attribute>Keying Material</attribute> (pair of private and  public keys)</ul>
    <ul>Data State: <attribute>Transferred </attribute>(over network)</ul>
    <ul>Algorithm: <attribute>Export RSA </attribute> (512-bits key generation based on prime numbers,  such that private key can be obtained from public key through factorization)</ul>
    <ul><u>Operation</u>: <attribute>Generate</attribute></ul>
  </ul>
  <ul><strong>Consequence: </strong><consequence>IEX Keying Material</consequence> (private key)</ul>

  <ul><u>Inner ENC</u>:</ul>
  <ul><strong>Causes: </strong><cause>KMN Fault </cause>leads to <cause>Exposed Private Key</cause></ul>
  <ul><strong>Attributes:</strong>
    <ul>Sensitive Data: <attribute>Cryptographic</attribute> (Pre-Master Secret)</ul>
    <ul>Data State: <attribute>Transferred </attribute>(over network)</ul>
    <ul>Algorithm: <attribute>Asymmetric</attribute> (RSA) (that allows decryption of Pre-Master Secret using exposed private key and computation of Master Secret)</ul>
    <ul><u>Security Service</u>: <attribute>Confidentiality</attribute></ul>
  </ul>
  <ul><strong>Consequence: </strong><consequence>IEX of Sensitive Data</consequence> (Master Secret)</ul>

  <ul><u>Outer ENC</u>:</ul>
  <ul><strong>Causes: </strong><cause>KMN Fault </cause>leads to <cause>Exposed Secret Key</cause> (Master Secret)</ul>
  <ul><strong>Attributes:</strong>
    <ul>Sensitive Data: <attribute>Credentials</attribute> (passwords, credit cards)</ul>
    <ul>Data State: <attribute>Transferred </attribute>(over network)</ul>
    <ul>Algorithm: <attribute>Symmetric</attribute> (key is known) </ul>
    <ul><u>Security Service</u>: <attribute>Confidentiality</attribute></ul>
  </ul>
  <ul><strong>Consequence: </strong><consequence>IEX of Sensitive Data</consequence> (credentials)</ul>

  <p><fontSS>BF Description</fontSS></p>
  <ul>An inner <u>KMN</u> leads to an inner <u>ENC</u>, which leads to an outer <u>ENC</u>.</ul>
  <ul><u>Inner KMN</u>: <cause>Improper offer of weak protocol</cause> (<attribute>Export RSA</attribute> from MITM-tricked server and accepted by client) allows use of 512-bits key <attribute>generation</attribute> (based on prime numbers) such that the private key can be obtained from the public key through factorization, which may be exploited for <consequence>IEX of keying material</consequence> (private key).</ul>
  <ul><u>Inner ENC</u>: <cause>KMN fault</cause> leads to <cause>exposed private key</cause> for <attribute>asymmetric</attribute> encryption (RSA) that allows decryption of <attribute>transferred</attribute> (over network) <attribute>cryptographic</attribute> data (Pre-Master Secret) and computation of other <attribute>cryptographic</attribute> data (Master Secret), which is <attribute>confidentiality</attribute> failure and <consequence>IEX of sensitive data</consequence> (Master Secret).</ul>
  <ul><u>Outer ENC</u>: <cause>KMN fault</cause> leads to <cause>exposed secret key</cause> (Master Secret) for <attribute>symmetric</attribute> encryption allows decryption of <attribute>credentials</attribute> (passwords, credit cards, etc.) <attribute>transferred</attribute> (over network), which is <attribute>confidentiality</attribute> failure and <consequence>IEX of sensitive data</consequence> (passwords, credit cards, etc.). <a href="#ref">[1]</a></ul>

  <p><fontSS>CVE Descriptions</fontSS></p>
      <p><ul>"The ssl3_get_key_exchange function in s3_clnt.c in OpenSSL before 0.9.8zd, 1.0.0 before 1.0.0p, and 1.0.1 before 1.0.1k allows remote SSL servers to conduct RSA-to-EXPORT_RSA downgrade attacks and facilitate brute-force decryption by offering a weak ephemeral RSA key in a noncompliant role, related to the "FREAK" issue. NOTE: the scope of this CVE is only client code based on OpenSSL, not EXPORT_RSA issues associated with servers or other TLS implementations." <a href="#ref">[4]</a></ul></p>
      <p><ul>"Schannel (aka Secure Channel) in Microsoft Windows Server 2003 SP2, Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2, and Windows RT Gold and 8.1 does not properly restrict TLS state transitions, which makes it easier for remote attackers to conduct cipher-downgrade attacks to EXPORT_RSA ciphers via crafted TLS traffic, related to the "FREAK" issue, a different vulnerability than CVE-2015-0204 and CVE-2015-1067." <a href="#ref">[5]</a></ul></p>
      <p><ul>"Secure Transport in Apple iOS before 8.2, Apple OS X through 10.10.2, and Apple TV before 7.1 does not properly restrict TLS state transitions, which makes it easier for remote attackers to conduct cipher-downgrade attacks to EXPORT_RSA ciphers via crafted TLS traffic, related to the "FREAK" issue, a different vulnerability than CVE-2015-0204 and CVE-2015-1637." <a href="#ref">[6]</a></ul></p>

  <p><fontSS>Analysis</fontSS></p>
      <p><ul>The following analysis is based on information in <a href="#ref">[7, 8, 9, 10]</a>: The server offers a weak protocol (Export RSA) while the client requested strong protocol (RSA).
</ul>
<ul>Communication is encrypted by symmetric encryption. The key for that encryption (Master Secret) is created by both client and server from a Pre-Master Secret and nonces sent by client and server. The Pre-Master Secret is sent encrypted by RSA cryptosystem. The client requests RSA protocol, but man in the middle (MITM) intercepts and requests Export RSA that uses a 512 bit key. Factoring a 512 bit RSA key is feasible.</ul>
<ul>Because of a bug, the client agrees to Export RSA. MITM factors the public 512 bit public RSA key, uses this factoring to recover the private RSA key, and then uses that private key to decrypt the Pre-Master Secret. Then it uses the Pre-Master Secret and the nonces to generate the Master Secret. The Master Secret enables MITM to decrypt the encrypted communication from that point on. </ul></p>
  <p>
      <fontSS>Source Code</fontSS>
  </p>
  <p>
    <ul>
        <table  align="center" class="table-responsive">
            <tr>
                <td align="center"> FREAK Client Code With Bug</td>

            <tr>
<td>
   <div class="sourceCodeTable"><table><tr><td><pre style="margin: 0; line-height: 125%">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
</pre></td><td><pre style="margin: 0; line-height: 125%">#<keyword>ifndef</keyword> OPENSSL_NO_RSA
  <keyword>if</keyword> (alg_k <span style="color: #333333">&amp;</span> SSL_kRSA)
    {







      <keyword>if</keyword> ((rsa<span style="color: #333333">=</span><keyword>RSA_new</keyword>()) <span style="color: #333333">==</span> <span style="color: #007020"><keyword>NULL</keyword></span>)
        {
          <keyword>SSLerr</keyword>(SSL_F_SSL3_GET_KEY_EXCHANGE,ERR_R_MALLOC_FAILURE);
</pre></td></tr></table></div>
</td>


</tr>
<td align="center"> FREAK Client Code With Fix</td>
<tr>

<td>
  <div class="sourceCodeTable" style="width:auto;"><table><tr><td><pre style="margin: 0; line-height: 125%">  1
  2
  3
  <span class="addLine">4
  5
  6
  7
  8
  9
 10</span>
 11
 12
 13
</pre></td><td><pre style="margin: 0; line-height: 125%">#<keyword>ifndef</keyword> OPENSSL_NO_RSA
    <keyword>if</keyword> (alg_k <span style="color: #333333">&amp;</span> SSL_kRSA)
     {
        <comment>/* Temporary RSA keys only allowed in export ciphersuites */</comment>
        <keyword>if</keyword> (!<keyword>SSL_C_IS_EXPORT</keyword>(s<span style="color: #333333">-&gt;s3<span style="color: #333333">-&gt;</span>tmp.new_cipher))
          {
     al<span style="color: #333333">=</span>SSL_AD_UNEXPECTED_MESSAGE;
            <keyword>SSLerr</keyword>(SSL_F_SSL3_GET_SERVER_CERTIFICATE,SSL_R_UNEXPECTED_MESSAGE);
            <keyword>goto</keyword> f_err;
          }
        <keyword>if</keyword> ((rsa<span style="color: #333333">=</span><keyword>RSA_new</keyword>()) <span style="color: #333333">==</span> <span style="color: #007020"><keyword>NULL</keyword></span>)
          {
            <keyword>SSLerr</keyword>(SSL_F_SSL3_GET_KEY_EXCHANGE,ERR_R_MALLOC_FAILURE);</pre></td></tr></table></div>
</td>
</tr>
<td align="center" style="padding-top: 25px;"> FREAK Server Code With Bug</td>
<tr>

<td>
  <div class="sourceCodeTable"><table><tr><td><pre style="margin: 0; line-height: 125%">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
</pre></td><td><pre style="margin: 0; line-height: 125%">  <keyword>case</keyword> SSL3_ST_SW_KEY_EXCH_B:
    alg_k <span style="color: #333333">=</span> s<span style="color: #333333">-&gt;</span>s3<span style="color: #333333">-&gt;</span>tmp.new_cipher<span style="color: #333333">-&gt;</span>algorithm_mkey;
    <comment>/* clear this, it may get reset by send_server_key_exchange */</comment>
    <keyword>if</keyword> ((s<span style="color: #333333">-&gt;</span>options <span style="color: #333333">&amp;</span> SSL_OP_EPHEMERAL_RSA)
#<keyword>ifndef</keyword> OPENSSL_NO_KRB5
      <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">!</span>(alg_k <span style="color: #333333">&amp;</span> SSL_kKRB5)
#<keyword>endif</keyword> <span style="color: #888888">/* OPENSSL_NO_KRB5 */</span><span style="color: #557799"></span>)
      <span style="color: #888888">/* option SSL_OP_EPHEMERAL_RSA sends temporary RSA key even when forbidden</span>
      <span style="color: #888888"> * by protocol specs (handshake may fail as clients are not required to</span>
      <span style="color: #888888"> * be able to handle this) */</span>
      s<span style="color: #333333">-&gt;</span>s3<span style="color: #333333">-&gt;</span>tmp.use_rsa_tmp<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">1</span>;
    <keyword>else</keyword>
      s<span style="color: #333333">-&gt;</span>s3<span style="color: #333333">-&gt;</span>tmp.use_rsa_tmp<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">0</span>;
    <keyword>if</keyword> (s->s3->tmp.use_rsa_tmp</pre></td></tr></table></div>
</td>
</tr>
<td align="center"> FREAK Server Code With Fix</td>
<tr>

<td>
  <div class="sourceCodeTable"><table><tr><td><pre style="margin: 0; line-height: 125%">  1
  2
  3
  <span class="addLine">4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14</span>
</pre></td><td><pre style="margin: 0; line-height: 125%">  <keyword>case</keyword> SSL3_ST_SW_KEY_EXCH_B:
    alg_k <span style="color: #333333">=</span> s<span style="color: #333333">-&gt;</span>s3<span style="color: #333333">-&gt;</span>tmp.new_cipher<span style="color: #333333">-&gt;</span>algorithm_mkey;
    <comment>/* clear this, it may get reset by send_server_key_exchange */</comment>
    s<span style="color: #333333">-&gt;</span>s3<span style="color: #333333">-&gt;</span>tmp.use_rsa_tmp<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">0</span>;









   <keyword>if</keyword> (</pre></td></tr></table></div>
</td>
</tr>
        </table>
    </ul>
  </p>

  <div align="center"><img src="../images/thinLine.jpg"></div>
  <p class="text-info"><fontS><a name="ref">References</a></fontS></p>
  <small>
  <ul>[1] Bojanova, I., Black, P. E., Yesha, Y., Wu, Yan, Evans, Z., Poster: The Bugs Framework (BF) – First Classes: Buffer Overflow (BOF), Injection (INJ), Control of Interaction Frequency (CIF), STC 2017, NIST, Gaithersburg, MD, USA.</ul>
  <ul>[2] The MITRE Corporation, <a target="_blank" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1919">CVE-2016-1919</a>.</ul>
  <ul>[3] openwall.net, [CVE-2016-1919] "<a target="_blank" href="http://lists.openwall.net/bugtraq/2016/01/17/2">Weak eCryptFS Key generation from user password</a>."</ul>
  <ul>[4] The MITRE Corporation, <a target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2015-0204">CVE-2015-0204</a>.</ul>
  <ul>[5] The MITRE Corporation, <a target="_blank" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1637">CVE-2015-1637</a>.</ul>
  <ul>[6] The MITRE Corporation, <a target="_blank" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1067">CVE-2015-1067</a>.</ul>
  <ul>[7] R. Heaton, "<a target="_blank" href="https://robertheaton.com/2015/04/06/the-ssl-freak-vulnerability/">The SSL FREAK vulnerability explained</a>."</ul>
  <ul>[8] Censys, <a target="_blank" href="https://censys.io/blog/freak">The FREAK Attack</a>.</ul>
  <ul>[9] StackExchange, <a target="_blank" href="https://android.stackexchange.com/questions/101929/protecting-phone-from-the-freak-bug/101966">Protecting phone from the FREAK bug</a>.</ul>
  <ul>[10] GitHub, openssl, <a target="_blank" href="https://github.com/openssl/openssl/commit/ce325c60c74b0fa784f5872404b722e120e5cab0?diff=split">Only allow ephemeral RSA keys in export ciphersuites</a>.</ul>
  </small>
</div>-->
    <footer class="sticky-footer">
    <div class="nist-footer__inner">
      <div class="nist-footer__menu" role="navigation">
        <ul>
          <li class="nist-footer__menu-item">
            <a href="https://www.nist.gov/privacy-policy">Site Privacy</a>
          </li>
          <li class="nist-footer__menu-item">
            <a href="https://www.nist.gov/oism/accessibility">Accessibility</a>
          </li>
          <li class="nist-footer__menu-item">
            <a href="https://www.nist.gov/privacy">Privacy Program</a>
          </li>
          <li class="nist-footer__menu-item">
            <a href="https://www.nist.gov/oism/copyrights">Copyrights</a>
          </li>
          <li class="nist-footer__menu-item">
            <a href="https://www.commerce.gov/vulnerability-disclosure-policy">Vulnerability Disclosure</a>
          </li>
          <li class="nist-footer__menu-item">
            <a href="https://www.nist.gov/no-fear-act-policy">No Fear Act Policy</a>
          </li>
          <li class="nist-footer__menu-item">
            <a href="https://www.nist.gov/foia">FOIA</a>
          </li>
          <li class="nist-footer__menu-item">
            <a href="https://www.nist.gov/environmental-policy-statement">Environmental Policy</a>
          </li>
          <li class="nist-footer__menu-item ">
            <a href="https://www.nist.gov/summary-report-scientific-integrity">Scientific Integrity</a>
          </li>
          <li class="nist-footer__menu-item ">
            <a href="https://www.nist.gov/nist-information-quality-standards">Information Quality Standards</a>
          </li>
          <li class="nist-footer__menu-item">
            <a href="https://www.commerce.gov/">Commerce.gov</a>
          </li>
          <li class="nist-footer__menu-item">
            <a href="http://www.science.gov/">Science.gov</a>
          </li>
          <li class="nist-footer__menu-item">
            <a href="http://www.usa.gov/">USA.gov</a>
          </li>
        </ul>
      </div>
    </div>
     
  </footer>
    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
      <i class="fa fa-angle-up"></i>
    </a>


    <!-- Bootstrap core JavaScript-->
    <script src="../vendor/jquery/jquery.min.js"></script>
    <script src="../vendor/popper/popper.min.js"></script>
    <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>
    <!-- Core plugin JavaScript-->
    <script src="../vendor/jquery-easing/jquery.easing.min.js"></script>
    <!-- Custom scripts for all pages-->
    <script src="../js/custom.js"></script>
    <!-- Custom scripts for this page-->
    <!-- Toggle between fixed and static navbar-->


  </div>
</body>

</html>